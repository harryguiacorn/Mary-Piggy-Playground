<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mary‚Äôs Piggy Playground ‚Äî Games for Kids</title>
  <meta name="description" content="A kid-safe mini-site starring Mary the piggy with simple games." />
  <style>
    :root{
      --pink-100:#fff1f5;
      --pink-200:#ffdbe6;
      --pink-300:#ffc3d6;
      --pink-400:#ff9fc0;
      --pink-500:#ff75a3;
      --pink-600:#ff4f8a;
      --ink:#2c2c35;
      --bg:#fff8fb;
      --card:#ffffffcc;
      --focus:#3b82f6;
      --success:#22c55e;
      --accent:#ff6fa8;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, "Comic Sans MS", "Comic Neue", "Fredoka", "Poppins", sans-serif;
      color:var(--ink);
      background:
        radial-gradient(40vmax 40vmax at -10% -10%, var(--pink-200), transparent 60%) no-repeat,
        radial-gradient(35vmax 35vmax at 110% 0%, var(--pink-300), transparent 60%) no-repeat,
        linear-gradient(180deg, var(--bg), var(--pink-100));
      min-height:100%;
      overflow-x:hidden;
    }
    header{
      position:sticky; top:0; z-index:50;
      background:linear-gradient(180deg, #fff, #fff7fb);
      border-bottom:1px solid #f6c8dc;
      padding:10px 16px;
      display:flex; align-items:center; gap:12px; flex-wrap:wrap;
    }
    .logo{
      display:flex; align-items:center; gap:12px; font-weight:900; font-size:1.25rem;
    }
    .logo .pig{font-size:1.6rem}
    /* Cute Mary logo badge */
    .mary-logo{
      display:inline-flex; align-items:center; gap:2px;
      padding:4px 10px;
      border-radius:999px;
      background:linear-gradient(180deg, #ffe3ee, #ffc3d9);
      border:2px solid #f1a3c4;
      box-shadow:0 2px 0 #f1a3c4;
      color:#b51566;
      line-height:1;
      font-weight:900;
      font-size:1rem;
    }
    .mary-logo .snout{ margin:0 2px; filter:drop-shadow(0 1px 0 rgba(0,0,0,.06)) }
    .mary-logo .sparkle{ margin-left:4px }

    nav{display:flex; gap:8px; flex-wrap:wrap; margin-left:auto}
    button, .btn{
      appearance:none; border-radius:14px; border:2px solid var(--pink-400);
      background:var(--pink-200); color:var(--ink);
      padding:10px 14px; font-size:1rem; font-weight:700; cursor:pointer;
      box-shadow:0 2px 0 var(--pink-400);
      transition:transform .05s ease, box-shadow .05s ease, background .2s;
    }
    button:hover{background:var(--pink-300)}
    button:active{transform:translateY(1px); box-shadow:0 1px 0 var(--pink-400)}
    button:focus-visible{outline:3px solid var(--focus); outline-offset:2px}
    .ghost{background:#fff; border-color:#e9b8cd; box-shadow:none}
    .wrap{max-width:1100px; margin:0 auto; padding:20px 16px}
    .screen{display:none; animation:fade .25s ease}
    .screen.active{display:block}
    @keyframes fade{from{opacity:.6; transform:translateY(4px)} to{opacity:1; transform:translateY(0)}}

    /* Home */
    .hero{
      display:grid; grid-template-columns: 1.1fr .9fr; gap:22px; align-items:center;
      background:var(--card); border:2px solid #f3c3d7; border-radius:18px; padding:20px;
      backdrop-filter:saturate(120%) blur(2px);
    }
    .hero h1{font-size:2rem; margin:.2rem 0}
    .hero p{font-size:1.05rem; margin:.5rem 0 1rem}
    .big-pig{
      font-size:110px; text-align:center; line-height:1;
      filter:drop-shadow(0 6px 0 #f1b6cf);
    }
    .cards{display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:14px; margin-top:16px}
    .card{
      background:#fff; border:2px solid #f1b6cf; border-radius:16px; padding:14px;
      display:flex; gap:12px; align-items:center; justify-content:space-between;
    }
    .card .emoji{font-size:2rem}
    .card .title{font-weight:900}
    .card .desc{font-size:.95rem; color:#444}
    .card .go{white-space:nowrap}

    /* Pop-a-Piggy */
    .grid{display:grid; grid-template-columns:repeat(3, 1fr); gap:12px; margin-top:12px}
    .hole{
      position:relative; aspect-ratio: 1 / 1;
      background:linear-gradient(180deg, #ffd3e3, #ffb8d3);
      border:2px solid #f1a3c4; border-radius:18px; overflow:hidden;
    }
    .hole .label{
      position:absolute; inset:auto 0 6px 0; text-align:center; opacity:.45; font-size:.75rem
    }
    .piggy{
      position:absolute; inset:auto auto 6px 50%; transform:translate(-50%, 100%);
      transition:transform .15s ease; font-size:2.3rem;
      filter: drop-shadow(0 6px 0 rgba(0,0,0,.08));
      user-select:none;
    }
    .piggy.up{transform:translate(-50%, 0)}
    .scorebar{display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .score{
      background:#fff; border:2px solid #f1a3c4; border-radius:12px; padding:8px 10px; font-weight:800;
      min-width:90px; text-align:center;
    }
    .timer{min-width:90px}
    .muted{opacity:.7}

    /* Memory Match */
    .memory-grid{
      display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; margin-top:12px
    }
    .cardx{
      position:relative; aspect-ratio: 3 / 4;
      perspective:800px; border-radius:12px; overflow:hidden; border:2px solid #f1a3c4;
      background:#ffd5e6;
    }
    .cardx button{
      all:unset; display:block; width:100%; height:100%; cursor:pointer; position:relative;
    }
    .face{
      position:absolute; inset:0; display:grid; place-items:center; font-size:2rem; font-weight:900;
      backface-visibility:hidden; transition: transform .32s ease;
    }
    .front{background:#fff; transform:rotateY(0)}
    .back{background:linear-gradient(180deg, #ffb9d6, #ffa2c8); color:#fff; transform:rotateY(180deg)}
    .flipped .front{transform:rotateY(-180deg)}
    .flipped .back{transform:rotateY(0)}
    .matched{filter:grayscale(.2) saturate(1.4) brightness(1.08); border-color:#8bd49b}

    /* Mary tag on memory cards */
    .face{position:relative}
    .tag{
      position:absolute; top:6px; left:6px;
      padding:2px 8px; font-size:.75rem; font-weight:800;
      color:#b51566;
      background:linear-gradient(180deg, #ffe3ee, #ffc3d9);
      border:2px solid #f1a3c4; border-radius:999px;
      box-shadow:0 2px 0 #f1a3c4;
      transform:rotate(-5deg);
      user-select:none; pointer-events:none;
    }

    /* Dress & Color */
    .dress-wrap{
      display:grid; grid-template-columns: 1fr 320px; gap:16px; align-items:start; margin-top:12px
    }
    .canvas{
      background:#fff; border:2px solid #f1a3c4; border-radius:16px; padding:12px; position:relative; overflow:hidden;
      min-height:340px; display:grid; place-items:center;
    }
    .toolbox{
      background:#fff; border:2px solid #f1a3c4; border-radius:16px; padding:12px; display:flex; flex-direction:column; gap:10px
    }
    .palette{display:flex; flex-wrap:wrap; gap:8px}
    .swatch{
      width:28px; height:28px; border-radius:50%; border:2px solid #e7b1c8; cursor:pointer;
      box-shadow:0 2px 0 #e7b1c8;
    }
    .swatch.selected{outline:3px solid var(--focus); outline-offset:2px}
    .toggles{display:flex; gap:8px; flex-wrap:wrap}
    .mini{font-size:.9rem; padding:8px 10px}
    .note{font-size:.9rem; color:#555}
    svg{max-width:380px; width:100%; height:auto}
    .hidden{display:none}

    /* Confetti */
    .confetti{pointer-events:none; position:fixed; inset:0; overflow:hidden; z-index:1000}
    .confetti .piece{
      position:absolute; font-size:24px; will-change: transform, opacity;
      animation: fall linear forwards;
      text-shadow: 0 2px 0 rgba(0,0,0,.05);
    }
    @keyframes fall{
      0% { transform: translateY(-8vh) rotate(0deg); opacity:1 }
      100% { transform: translateY(110vh) rotate(360deg); opacity:0.9 }
    }

    footer{
      opacity:.8; font-size:.9rem; text-align:center; padding:18px 10px
    }

    @media (max-width: 860px){
      .hero{grid-template-columns: 1fr}
      .dress-wrap{grid-template-columns: 1fr}
    }
  </style>
</head>
<body>
  <header>
    <div class="logo" aria-label="Mary‚Äôs Piggy Playground">
      <span class="mary-logo" role="img" aria-label="Mary logo">
        <span class="m">M</span><span class="snout">üêΩ</span><span class="ry">ry</span><span class="sparkle">‚ú®</span>
      </span>
      <span>Mary‚Äôs Piggy Playground</span>
    </div>
    <nav>
      <button class="ghost" data-goto="#home" aria-label="Home">Home</button>
      <button data-goto="#whack" aria-label="Pop‚Äëa‚ÄëMary">Pop‚Äëa‚ÄëMary</button>
      <button data-goto="#memory" aria-label="Memory Match with Mary">Memory Match</button>
      <button data-goto="#dress" aria-label="Dress & Color Mary">Dress Mary</button>
      <button id="muteBtn" class="ghost" aria-pressed="false" title="Sound on/off">üîä Sound</button>
    </nav>
  </header>

  <div class="wrap">
    <!-- Home -->
    <section id="home" class="screen active" role="region" aria-label="Home">
      <div class="hero">
        <div>
          <h1>Welcome to Mary‚Äôs Piggy Playground! üê∑‚ú®</h1>
          <p>Play kid‚Äëfriendly mini‚Äëgames with Mary the piggy, dress her up, and paint happy colors. No accounts, no ads, and it runs offline.</p>
          <div class="cards">
            <div class="card">
              <div>
                <div class="title">Pop‚Äëa‚ÄëMary</div>
                <div class="desc">Tap Mary when she pops up!</div>
              </div>
              <div class="emoji" aria-hidden="true">üê∑üî®</div>
              <button class="go" data-goto="#whack">Play</button>
            </div>
            <div class="card">
              <div>
                <div class="title">Memory Match with Mary</div>
                <div class="desc">Find Mary‚Äôs matching pairs.</div>
              </div>
              <div class="emoji" aria-hidden="true">üê∑üß†</div>
              <button class="go" data-goto="#memory">Play</button>
            </div>
            <div class="card">
              <div>
                <div class="title">Dress & Color Mary</div>
                <div class="desc">Pick colors and accessories for Mary!</div>
              </div>
              <div class="emoji" aria-hidden="true">üê∑üéÄ</div>
              <button class="go" data-goto="#dress">Play</button>
            </div>
          </div>
        </div>
        <div class="big-pig" aria-hidden="true">üê∑</div>
      </div>
    </section>

    <!-- Pop-a-Piggy -->
    <section id="whack" class="screen" role="region" aria-label="Pop Mary game">
      <h2>Pop‚Äëa‚ÄëMary üê∑üî®</h2>
      <div class="scorebar">
        <div class="score">Score: <span id="whackScore">0</span></div>
        <div class="score timer">Time: <span id="whackTime">30</span>s</div>
        <div class="score">Best: <span id="whackBest">0</span></div>
        <button id="whackStart">Start</button>
      </div>
      <div class="grid" aria-live="polite">
        <div class="hole"><div class="label">Hole 1</div></div>
        <div class="hole"><div class="label">Hole 2</div></div>
        <div class="hole"><div class="label">Hole 3</div></div>
        <div class="hole"><div class="label">Hole 4</div></div>
        <div class="hole"><div class="label">Hole 5</div></div>
        <div class="hole"><div class="label">Hole 6</div></div>
        <div class="hole"><div class="label">Hole 7</div></div>
        <div class="hole"><div class="label">Hole 8</div></div>
        <div class="hole"><div class="label">Hole 9</div></div>
      </div>
    </section>

    <!-- Memory Match -->
    <section id="memory" class="screen" role="region" aria-label="Memory Match with Mary">
      <h2>Memory Match with Mary üê∑üß†</h2>
      <div class="scorebar">
        <div class="score">Moves: <span id="memMoves">0</span></div>
        <div class="score">Best: <span id="memBest">‚Äî</span></div>
        <button id="memNew">New Game</button>
      </div>
      <div id="memoryGrid" class="memory-grid" aria-live="polite"></div>
    </section>

    <!-- Dress & Color -->
    <section id="dress" class="screen" role="region" aria-label="Dress and Color Mary">
      <h2>Dress & Color Mary üê∑üéÄ</h2>
      <div class="dress-wrap">
        <div class="canvas">
          <!-- Pig SVG -->
          <svg id="pigSVG" viewBox="0 0 300 260" aria-label="Mary the pig" role="img">
            <!-- Body -->
            <g id="pig">
              <ellipse id="body" cx="150" cy="150" rx="100" ry="80" fill="#ffb4c8" stroke="#e08dae" stroke-width="4"/>
              <circle id="head" cx="150" cy="105" r="60" fill="#ffc0d2" stroke="#e08dae" stroke-width="4"/>
              <!-- Ears -->
              <path id="earL" d="M110,65 L85,35 L115,50 Z" fill="#ffb4c8" stroke="#e08dae" stroke-width="4" />
              <path id="earR" d="M190,65 L215,35 L185,50 Z" fill="#ffb4c8" stroke="#e08dae" stroke-width="4" />
              <!-- Eyes -->
              <circle cx="130" cy="105" r="6" fill="#2c2c35"/><circle cx="170" cy="105" r="6" fill="#2c2c35"/>
              <!-- Snout -->
              <ellipse id="snout" cx="150" cy="130" rx="26" ry="18" fill="#ff9ebb" stroke="#e08dae" stroke-width="4"/>
              <circle cx="142" cy="130" r="3" fill="#2c2c35"/><circle cx="158" cy="130" r="3" fill="#2c2c35"/>
              <!-- Cheeks -->
              <circle id="cheekL" cx="118" cy="128" r="7" fill="#ff97b6" opacity=".7"/>
              <circle id="cheekR" cx="182" cy="128" r="7" fill="#ff97b6" opacity=".7"/>
            </g>
            <!-- Accessories -->
            <g id="hat" class="hidden">
              <path d="M105,65 h90 v12 h-90 z" fill="#222" />
              <path d="M120,45 h60 v22 h-60 z" fill="#333" />
              <path d="M120,45 h60 v8 h-60 z" fill="#ffeb3b" opacity=".8"/>
            </g>
            <g id="glasses" class="hidden">
              <circle cx="130" cy="105" r="14" fill="none" stroke="#222" stroke-width="4"/>
              <circle cx="170" cy="105" r="14" fill="none" stroke="#222" stroke-width="4"/>
              <rect x="144" y="101" width="12" height="4" fill="#222"/>
            </g>
            <g id="bow" class="hidden">
              <path d="M140,160 c-18,-12 -24,-10 -30,0 c6,10 12,12 30,0 z" fill="#ff4f8a"/>
              <path d="M160,160 c18,-12 24,-10 30,0 c-6,10 -12,12 -30,0 z" fill="#ff4f8a"/>
              <circle cx="150" cy="160" r="6" fill="#d81b60"/>
            </g>
          </svg>
        </div>
        <div class="toolbox" aria-label="Tools">
          <div><strong>Paint color</strong></div>
          <div class="palette" id="palette" role="listbox" aria-label="Color palette">
            <button class="swatch selected" data-color="#ffc0d2" style="background:#ffc0d2" aria-label="Pink" aria-selected="true"></button>
            <button class="swatch" data-color="#ffd166" style="background:#ffd166" aria-label="Sunny yellow"></button>
            <button class="swatch" data-color="#a3e635" style="background:#a3e635" aria-label="Lime green"></button>
            <button class="swatch" data-color="#60a5fa" style="background:#60a5fa" aria-label="Blue"></button>
            <button class="swatch" data-color="#f472b6" style="background:#f472b6" aria-label="Bright pink"></button>
            <button class="swatch" data-color="#f97316" style="background:#f97316" aria-label="Orange"></button>
            <button class="swatch" data-color="#a78bfa" style="background:#a78bfa" aria-label="Purple"></button>
            <button class="swatch" data-color="#34d399" style="background:#34d399" aria-label="Mint"></button>
          </div>
          <div class="toggles">
            <button id="paintBody" class="mini">Paint Body</button>
            <button id="paintHead" class="mini">Paint Head</button>
            <button id="paintEars" class="mini">Paint Ears</button>
            <button id="paintSnout" class="mini">Paint Snout</button>
            <button id="clearColors" class="mini ghost">Reset Colors</button>
          </div>
          <div><strong>Accessories</strong></div>
          <div class="toggles">
            <button id="toggleHat" class="mini">üé© Hat</button>
            <button id="toggleGlasses" class="mini">üï∂Ô∏è Glasses</button>
            <button id="toggleBow" class="mini">üéÄ Bow</button>
            <button id="clearAcc" class="mini ghost">Clear</button>
          </div>
          <div class="note">Tip: Try different colors for Mary, then add accessories!</div>
        </div>
      </div>
    </section>
  </div>

  <div id="confetti" class="confetti" aria-hidden="true"></div>

  <footer>
    Made with oinks. No ads, no tracking, works offline. Have fun with Mary! üê∑
  </footer>

  <script>
    // Navigation
    const screens = Array.from(document.querySelectorAll('.screen'));
    function show(hash){
      const id = hash || '#home';
      screens.forEach(s => s.classList.toggle('active', '#' + s.id === id));
    }
    document.querySelectorAll('[data-goto]').forEach(btn=>{
      btn.addEventListener('click', ()=>{ location.hash = btn.dataset.goto; show(location.hash); });
    });
    window.addEventListener('hashchange', ()=> show(location.hash));
    show(location.hash || '#home');

    // Sound (simple synthesized "oink")
    let audioOn = true;
    const muteBtn = document.getElementById('muteBtn');
    muteBtn.addEventListener('click', ()=>{
      audioOn = !audioOn;
      muteBtn.textContent = audioOn ? 'üîä Sound' : 'üîá Muted';
      muteBtn.classList.toggle('muted', !audioOn);
      muteBtn.setAttribute('aria-pressed', String(!audioOn));
    });
    let actx;
    function oink(vol=0.15){
      if(!audioOn) return;
      try{
        actx = actx || new (window.AudioContext || window.webkitAudioContext)();
        const now = actx.currentTime;
        const g = actx.createGain();
        g.gain.value = 0;
        g.connect(actx.destination);
        // two short grunts
        const osc = actx.createOscillator();
        osc.type = 'square';
        osc.frequency.setValueAtTime(180, now);
        osc.frequency.exponentialRampToValueAtTime(140, now + 0.09);
        g.gain.linearRampToValueAtTime(vol, now + 0.02);
        g.gain.exponentialRampToValueAtTime(0.0001, now + 0.1);

        const osc2 = actx.createOscillator();
        const g2 = actx.createGain();
        g2.gain.value = 0; g2.connect(actx.destination);
        osc2.type = 'square';
        osc2.frequency.setValueAtTime(220, now + 0.12);
        osc2.frequency.exponentialRampToValueAtTime(160, now + 0.22);
        g2.gain.linearRampToValueAtTime(vol*0.9, now + 0.14);
        g2.gain.exponentialRampToValueAtTime(0.0001, now + 0.24);

        osc.connect(g); osc2.connect(g2);
        osc.start(now); osc.stop(now + 0.12);
        osc2.start(now + 0.12); osc2.stop(now + 0.26);
      }catch(e){}
    }

    // Confetti (piggy rain)
    function pigConfetti(count=18){
      const root = document.getElementById('confetti');
      for(let i=0;i<count;i++){
        const span = document.createElement('span');
        span.className = 'piece';
        span.textContent = 'üê∑';
        const left = Math.random()*100;
        const dur = 2 + Math.random()*2.5;
        const delay = Math.random()*0.4;
        span.style.left = left + 'vw';
        span.style.animationDuration = dur+'s';
        span.style.animationDelay = delay+'s';
        span.style.transform = `translateY(-10vh) rotate(${Math.random()*360}deg)`;
        root.appendChild(span);
        setTimeout(()=> span.remove(), (dur+delay)*1000 + 50);
      }
    }

    // LocalStorage helpers
    function setBest(key, val){
      const cur = Number(localStorage.getItem(key) || 0);
      if(key.includes('mem')){
        if(cur===0 || val < cur) localStorage.setItem(key, String(val));
      }else{
        if(val > cur) localStorage.setItem(key, String(val));
      }
    }
    function getBest(key){ return Number(localStorage.getItem(key) || 0) || 0; }

    // ========== Pop-a-Mary ==========
    const holes = Array.from(document.querySelectorAll('.grid .hole'));
    const whackScoreEl = document.getElementById('whackScore');
    const whackTimeEl = document.getElementById('whackTime');
    const whackBestEl = document.getElementById('whackBest');
    const whackStartBtn = document.getElementById('whackStart');

    let whackTimer = null, whackTime = 30, whackScore = 0, pigTimer = null, playingWhack = false, lastHole = -1;

    function randHole(){
      let idx;
      do { idx = Math.floor(Math.random()*holes.length) } while(idx===lastHole);
      lastHole = idx;
      return holes[idx];
    }
    function spawnPig(){
      const hole = randHole();
      const pig = document.createElement('button');
      pig.className = 'piggy';
      pig.setAttribute('aria-label', 'Mary, tap!');
      pig.textContent = 'üê∑';
      hole.appendChild(pig);
      requestAnimationFrame(()=> pig.classList.add('up'));
      const hideAfter = 600 + Math.random()*700;
      const t = setTimeout(()=>{
        pig.classList.remove('up');
        setTimeout(()=> pig.remove(), 200);
      }, hideAfter);
      pig.addEventListener('click', (e)=>{
        e.stopPropagation();
        whackScore++;
        whackScoreEl.textContent = whackScore;
        oink(0.18);
        pig.textContent = 'üêñ';
        pig.classList.remove('up');
        clearTimeout(t);
        setTimeout(()=> pig.remove(), 120);
      }, {once:true});
    }
    function startWhack(){
      if(playingWhack) return;
      playingWhack = true;
      whackScore = 0; whackTime = 30;
      whackScoreEl.textContent = '0'; whackTimeEl.textContent = String(whackTime);
      whackStartBtn.disabled = true;
      pigTimer = setInterval(spawnPig, 650);
      whackTimer = setInterval(()=>{
        whackTime--;
        whackTimeEl.textContent = String(whackTime);
        if(whackTime<=0) endWhack();
      }, 1000);
    }
    function endWhack(){
      clearInterval(whackTimer); clearInterval(pigTimer);
      whackTimer = pigTimer = null;
      playingWhack = false; whackStartBtn.disabled = false;
      document.querySelectorAll('.piggy').forEach(p=>p.remove());
      setBest('whackBest', whackScore);
      whackBestEl.textContent = String(getBest('whackBest'));
      pigConfetti(16);
      alert(`Time! You tapped Mary ${whackScore} times! üê∑`);
    }
    whackStartBtn.addEventListener('click', startWhack);
    whackBestEl.textContent = String(getBest('whackBest'));

    // ========== Memory Match ==========
    const stickers = ["üê∑üéÄ","üê∑üé©","üê∑üï∂Ô∏è","üê∑üëë","üê∑üéà","üê∑‚≠ê","üê∑üçì","üê∑üåà"];
    const memoryGrid = document.getElementById('memoryGrid');
    const memMovesEl = document.getElementById('memMoves');
    const memBestEl = document.getElementById('memBest');
    const memNewBtn = document.getElementById('memNew');
    let memLock = false, memFirst = null, memMoves = 0, memMatched = 0;

    function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]] } return a; }
    function newMemory(){
      memMoves = 0; memMatched = 0; memFirst = null; memLock = false;
      memMovesEl.textContent = '0';
      const items = shuffle([...stickers, ...stickers]);
      memoryGrid.innerHTML = '';
      items.forEach((txt)=>{
        const wrap = document.createElement('div'); wrap.className = 'cardx';
        const btn = document.createElement('button'); btn.setAttribute('aria-label','Card');
        btn.dataset.value = txt;
        btn.innerHTML = `
          <div class="face front">
            <div class="tag" aria-hidden="true">Mary</div>
            üêΩ
          </div>
          <div class="face back">
            <div class="tag" aria-hidden="true">Mary</div>
            ${txt}
          </div>
        `;
        wrap.appendChild(btn);
        memoryGrid.appendChild(wrap);
        btn.addEventListener('click', ()=> flipCard(btn, wrap));
      });
      const best = Number(localStorage.getItem('memBest')||0);
      memBestEl.textContent = best ? best : '‚Äî';
    }
    function flipCard(btn, wrap){
      if(memLock || wrap.classList.contains('matched') || wrap.classList.contains('flipped')) return;
      wrap.classList.add('flipped');
      oink(0.08);
      if(!memFirst){
        memFirst = {btn, wrap, val: btn.dataset.value};
      }else{
        memLock = true;
        memMoves++; memMovesEl.textContent = String(memMoves);
        const second = {btn, wrap, val: btn.dataset.value};
        if(memFirst.val === second.val){
          setTimeout(()=>{
            memFirst.wrap.classList.add('matched');
            second.wrap.classList.add('matched');
            memFirst = null; memLock = false; memMatched += 2;
            if(memMatched === stickers.length*2){
              setBest('memBest', memMoves);
              memBestEl.textContent = localStorage.getItem('memBest');
              pigConfetti(24);
              setTimeout(()=> alert(`You matched all of Mary‚Äôs pairs in ${memMoves} moves! üê∑üéâ`), 50);
            }
          }, 420);
        }else{
          setTimeout(()=>{
            memFirst.wrap.classList.remove('flipped');
            second.wrap.classList.remove('flipped');
            memFirst = null; memLock = false;
          }, 650);
        }
      }
    }
    memNewBtn.addEventListener('click', newMemory);
    newMemory();

    // ========== Dress & Color ==========
    const palette = document.getElementById('palette');
    let currentColor = '#ffc0d2';
    palette.addEventListener('click', e=>{
      const sw = e.target.closest('.swatch'); if(!sw) return;
      currentColor = sw.dataset.color;
      palette.querySelectorAll('.swatch').forEach(s=>{ s.classList.toggle('selected', s===sw); s.setAttribute('aria-selected', s===sw ? 'true' : 'false') });
      oink(0.06);
    });

    const pigSVG = document.getElementById('pigSVG');
    const parts = {
      body: document.getElementById('body'),
      head: document.getElementById('head'),
      earL: document.getElementById('earL'),
      earR: document.getElementById('earR'),
      snout: document.getElementById('snout'),
    };
    function paint(elem){ if(elem) { elem.setAttribute('fill', currentColor); oink(0.05); } }

    document.getElementById('paintBody').addEventListener('click', ()=> paint(parts.body));
    document.getElementById('paintHead').addEventListener('click', ()=> paint(parts.head));
    document.getElementById('paintEars').addEventListener('click', ()=> { paint(parts.earL); paint(parts.earR); });
    document.getElementById('paintSnout').addEventListener('click', ()=> paint(parts.snout));
    document.getElementById('clearColors').addEventListener('click', ()=>{
      parts.body.setAttribute('fill', '#ffb4c8');
      parts.head.setAttribute('fill', '#ffc0d2');
      parts.earL.setAttribute('fill', '#ffb4c8');
      parts.earR.setAttribute('fill', '#ffb4c8');
      parts.snout.setAttribute('fill', '#ff9ebb');
      oink(0.05);
    });

    function toggle(id){
      const el = document.getElementById(id);
      el.classList.toggle('hidden');
      oink(0.07);
    }
    document.getElementById('toggleHat').addEventListener('click', ()=> toggle('hat'));
    document.getElementById('toggleGlasses').addEventListener('click', ()=> toggle('glasses'));
    document.getElementById('toggleBow').addEventListener('click', ()=> toggle('bow'));
    document.getElementById('clearAcc').addEventListener('click', ()=>{
      ['hat','glasses','bow'].forEach(id => document.getElementById(id).classList.add('hidden'));
      oink(0.04);
    });

    // Accessibility: allow Enter/Space to activate palette swatches
    document.querySelectorAll('.swatch').forEach(sw=>{
      sw.setAttribute('role','option');
      sw.tabIndex = 0;
      sw.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ sw.click(); e.preventDefault(); }});
    });

    // Make sure best scores display if coming back later
    whackBestEl.textContent = String(getBest('whackBest'));
  </script>
</body>
</html>
